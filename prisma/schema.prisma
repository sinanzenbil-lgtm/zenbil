// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Admin {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  firstName String
  lastName  String
  role      AdminRole @default(ADMIN)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("admins")
}

model Location {
  id           String   @id @default(cuid())
  name         String
  address      String
  phone        String
  workingHours String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  vehicles     VehicleLocation[]
  reservations Reservation[]

  @@map("locations")
}

model Vehicle {
  id          String         @id @default(cuid())
  brand       String
  model       String
  year        Int
  plate       String         @unique
  transmission TransmissionType
  fuelType    FuelType
  category    VehicleCategory
  dailyPrice  Float
  deposit     Float
  features    String[]
  images      String[]
  isActive    Boolean        @default(true)
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt

  locations    VehicleLocation[]
  reservations Reservation[]

  @@map("vehicles")
}

model VehicleLocation {
  id         String   @id @default(cuid())
  vehicleId  String
  locationId String
  createdAt  DateTime @default(now())

  vehicle  Vehicle  @relation(fields: [vehicleId], references: [id], onDelete: Cascade)
  location Location @relation(fields: [locationId], references: [id], onDelete: Cascade)

  @@unique([vehicleId, locationId])
  @@map("vehicle_locations")
}

model Reservation {
  id           String            @id @default(cuid())
  vehicleId    String
  locationId   String
  pickupDate   DateTime
  returnDate   DateTime
  pickupTime   String
  returnTime   String
  firstName    String
  lastName     String
  email        String
  phone        String
  idNumber     String
  totalPrice   Float
  deposit      Float
  status       ReservationStatus @default(PENDING)
  notes        String?
  createdAt    DateTime          @default(now())
  updatedAt    DateTime          @updatedAt

  vehicle  Vehicle  @relation(fields: [vehicleId], references: [id])
  location Location @relation(fields: [locationId], references: [id])

  @@map("reservations")
}

enum AdminRole {
  SUPER_ADMIN
  ADMIN
}

enum TransmissionType {
  MANUAL
  AUTOMATIC
}

enum FuelType {
  GASOLINE
  DIESEL
  ELECTRIC
  HYBRID
}

enum VehicleCategory {
  ECONOMY
  COMFORT
  LUXURY
  SUV
}

enum ReservationStatus {
  PENDING
  CONFIRMED
  COMPLETED
  CANCELLED
}
